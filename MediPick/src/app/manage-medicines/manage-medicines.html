<div class="container-fluid py-4">
  
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h5>Manage Medicines</h5>
    <button class="btn btn-warning text-white" data-bs-toggle="modal" data-bs-target="#addMedicineModal">
  Add New Medicine
    </button>
  </div>

  <!-- Search and Filters -->
  <div class="row mb-3">
    <div class="col-md-6">
      <input [(ngModel)]="searchTerm" type="text" class="form-control" placeholder="Search by name..." />
    </div>
    <div class="col-md-3">
      <select [(ngModel)]="selectedStatus" class="form-select">
        <option value="">All Status</option>
        <option *ngFor="let stat of statuses" [value]="stat">{{stat}}</option>
      </select>
    </div>
  </div>

  <!-- Table -->
  <div class="card p-3">
    <table class="table table-hover align-middle">
      <thead>
        <tr>
          <th>Code</th>
          <th>Medicine</th>
          <th>Price</th>
          <th>Stock</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let med of filteredMedicines">
          <td>
             <span class="badge me-2" [style.backgroundColor]="'#'+(Math.random().toString(16).slice(2,8))">{{med.code}}</span>
          </td>
          <td>
            <strong>{{med.name}}</strong><br>
            <small class="text-muted">{{med.description}}</small>
          </td>
          <td>â‚¹{{med.price}}</td>
          <td>{{med.stock}}</td>
          <td>
            <span class="badge"
                  [ngClass]="{
                    'bg-success': med.status==='In Stock',
                    'bg-danger': med.status==='Out of Stock',
                    'bg-warning text-dark': med.status==='Low Stock'
                  }">
              {{med.status}}
            </span>
          </td>
          <td>
            <button class="btn btn-sm btn-outline-primary me-2" 
            (click)="openEditModal(med)" 
              data-bs-toggle="modal" data-bs-target="#editMedicineModal">
               Edit
            </button>
            <button class="btn btn-sm btn-outline-danger" (click)="deleteMedicine(med.name,med.code)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>

  <!-- Add Medicine Modal -->
<div class="modal fade" id="addMedicineModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add New Medicine</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="addMedicine()" #addForm="ngForm">
          
          <!-- Name -->
          <div class="mb-3">
            <label class="form-label">Name*</label>
            <input type="text" class="form-control" 
                   [(ngModel)]="newMedicine.medicineName" 
                   name="medicineName" required #medicineName="ngModel">
            <div class="text-danger" *ngIf="medicineName.invalid && medicineName.touched">
              Name is required.
            </div>
          </div>

          <!-- Brand -->
          <div class="mb-3">
            <label class="form-label">Brand*</label>
            <input type="text" class="form-control" 
                   [(ngModel)]="newMedicine.brand" 
                   name="brand" required #brand="ngModel">
            <div class="text-danger" *ngIf="brand.invalid && brand.touched">
              Brand is required.
            </div>
          </div>

          <!-- Price -->
          <div class="mb-3">
            <label class="form-label">Price*</label>
            <input type="number" min="0" class="form-control" 
                   [(ngModel)]="newMedicine.price" 
                   name="price" required #price="ngModel">
            <div class="text-danger" *ngIf="price.invalid && price.touched">
              Price is required.
            </div>
          </div>

          <!-- Quantity -->
          <div class="mb-3">
            <label class="form-label">Quantity Available*</label>
            <input type="number" min="0" class="form-control" 
                   [(ngModel)]="newMedicine.quantityAvailable" 
                   name="quantityAvailable" required #quantityAvailable="ngModel">
            <div class="text-danger" *ngIf="quantityAvailable.invalid && quantityAvailable.touched">
              Quantity available is required.
            </div>
          </div>

          <!-- Manufacture Date -->
          <div class="mb-3">
            <label class="form-label">Manufacture Date*</label>
            <input type="date" class="form-control" 
                   [(ngModel)]="newMedicine.manufactureDate" 
                   name="manufactureDate" required #manufactureDate="ngModel">
            <div class="text-danger" *ngIf="manufactureDate.invalid && manufactureDate.touched">
              Manufacture Date is required.
            </div>
          </div>

          <!-- Expiry Date -->
          <div class="mb-3">
            <label class="form-label">Expiry Date*</label>
            <input type="date" class="form-control" 
                   [(ngModel)]="newMedicine.expiryDate" 
                   name="expiryDate" required #expiryDate="ngModel">
            <div class="text-danger" *ngIf="expiryDate.invalid && expiryDate.touched">
              Expiry Date is required.
            </div>
          </div>

          <!-- Description -->
          <div class="mb-3">
            <label class="form-label">Description (Optional)</label>
            <textarea class="form-control" [(ngModel)]="newMedicine.description" name="description"></textarea>
          </div>

          <!-- Prescription Checkbox -->
          <div class="form-check mb-3">
            <input type="checkbox" class="form-check-input" [(ngModel)]="newMedicine.prescriptionRequired" name="prescriptionRequired">
            <label class="form-check-label">Prescription Required</label>
          </div>

          <div class="modal-footer">
            <button type="submit" class="btn btn-success" [disabled]="addForm.invalid" data-bs-dismiss="modal">
              Add Medicine
            </button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          </div>

        </form>
      </div>
    </div>
  </div>
</div>



 <!-- Edit Medicine Modal -->
<div class="modal fade" id="editMedicineModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Medicine</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="updateMedicine()" #editForm="ngForm">
          
          <!-- Name -->
          <div class="mb-3">
            <label class="form-label">Name*</label>
            <input type="text" class="form-control" 
                   [(ngModel)]="editFormData.medicineName" 
                   name="medicineName" required #editName="ngModel">
            <div class="text-danger" *ngIf="editName.invalid && editName.touched">
              Name is required.
            </div>
          </div>

          <!-- Brand -->
          <div class="mb-3">
            <label class="form-label">Brand*</label>
            <input type="text" class="form-control" 
                   [(ngModel)]="editFormData.brand" 
                   name="brand" required #editBrand="ngModel">
            <div class="text-danger" *ngIf="editBrand.invalid && editBrand.touched">
              Brand is required.
            </div>
          </div>

          <!-- Price -->
          <div class="mb-3">
            <label class="form-label">Price*</label>
            <input type="number" class="form-control" 
                   [(ngModel)]="editFormData.price" 
                   name="price" min="0" required #editPrice="ngModel">
            <div class="text-danger" *ngIf="editPrice.invalid && editPrice.touched">
              Price is required.
            </div>
          </div>

          <!-- Quantity -->
          <div class="mb-3">
            <label class="form-label">Quantity Available*</label>
            <input type="number" min="0" class="form-control" 
                   [(ngModel)]="editFormData.quantityAvailable" 
                   name="quantityAvailable" required #editQuantityAvailable="ngModel">
            <div class="text-danger" *ngIf="editQuantityAvailable.invalid && editQuantityAvailable.touched">
              Quantity available is required.
            </div>
          </div>

          <!-- Description -->
          <div class="mb-3">
            <label class="form-label">Description (Optional)</label>
            <textarea class="form-control" [(ngModel)]="editFormData.description" name="description"></textarea>
          </div>

          <div class="modal-footer">
            <button type="submit" class="btn btn-success" [disabled]="editForm.invalid" data-bs-dismiss="modal">
              Save Changes
            </button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          </div>

        </form>
      </div>
    </div>
  </div>
</div>


  </div>
</div>
